# GNN Power-Flow Predictor for IEEE 34-Bus

GNN-based voltage magnitude predictor for the IEEE 34-bus distribution feeder.

## Quick Start (Google Colab)

1. **Open in Colab:** [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/alitasavori/GNN-Sandia/blob/main/GNN2.ipynb)

2. **Enable GPU:** Runtime → Change runtime type → GPU

3. **Run the setup cell** at the top — it clones the repo and installs: `torch`, `torch-geometric`, `opendssdirect.py`, `pandas`, `numpy`

4. **Generate datasets** (Option 4 — no upload needed):
   - Run the dataset generation blocks in the notebook in order:
     1. First dataset (`gnn_samples_out`) — from notebook cell
     2. Second dataset (`gnn_samples_inj_full`) — `exec(open("run_injection_dataset.py").read())`
     3. Third dataset (`gnn_samples_loadtype_full`) — `exec(open("run_loadtype_dataset.py").read())`
   - Each takes ~30–60 min on Colab CPU. Run once, then datasets persist for the session.

5. **Train:** Run the training blocks. With GPU, training is much faster.

## Local Setup

```bash
pip install torch torch-geometric opendssdirect pandas numpy
```

## Datasets

- **gnn_samples_out** — 3 features (p_load, q_load, p_pv)
- **gnn_samples_inj_full** — 2 features (p_inj, q_inj)
- **gnn_samples_loadtype_full** — 13 features (load types, electrical distance, etc.)

Datasets are generated by the scripts; they are not in the repo (too large for GitHub).
